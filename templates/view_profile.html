{% extends "layout.html" %}

{% block title %}Profil Saya - Toko Bunga Indah{% endblock %}

{% block content %}
<section class="profile-section">
    <div class="container">
        <div class="profile-header">
            <div class="profile-avatar-container">
                {% if user.photo %}
                    <img src="{{ url_for('static', filename='uploads/' + user.photo) }}" alt="Foto Profil" class="profile-avatar">
                {% else %}
                    <div class="profile-avatar default-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                {% endif %}
                <div class="avatar-actions">
                    <a href="{{ url_for('edit_profile') }}" class="btn-edit-avatar" title="Ubah Foto Profil">
                        <i class="fas fa-camera"></i>
                    </a>
                </div>
            </div>
            <div class="profile-info">
                <h1>{{ user.name }}</h1>
                <p class="member-since">Member sejak {{ user.created_at|format_date }}</p>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Pesanan</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">4</div>
                        <div class="stat-label">Wishlist</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">2</div>
                        <div class="stat-label">Ulasan</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="profile-content">
            <div class="profile-details">
                <h2 class="section-title"><i class="fas fa-user-circle"></i> Informasi Pribadi</h2>
                
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-envelope"></i> Email
                    </div>
                    <div class="detail-value">{{ user.email }}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-phone"></i> Telepon
                    </div>
                    <div class="detail-value">{{ user.phone if user.phone else 'Belum diisi' }}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-map-marker-alt"></i> Alamat
                    </div>
                    <div class="detail-value">{{ user.address if user.address else 'Belum diisi' }}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-graduation-cap"></i> Program Studi
                    </div>
                    <div class="detail-value">{{ user.programstudi if user.programstudi else 'Belum diisi' }}</div>
                </div>
                
                <div class="profile-actions">
                    <a href="{{ url_for('edit_profile') }}" class="btn btn-primary">
                        <i class="fas fa-edit"></i> Edit Profil
                    </a>
                    <a href="{{ url_for('change_password') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-lock"></i> Ubah Password
                    </a>
                </div>
            </div>

            <div class="profile-sidebar">
                <div class="sidebar-card">
                    <h3><i class="fas fa-trophy"></i> Poin Reward</h3>
                    <div class="reward-points">250</div>
                    <p>Anda memiliki 250 poin yang bisa ditukarkan dengan hadiah</p>
                    <a href="#" class="btn btn-reward">Lihat Hadiah</a>
                </div>
                
                <div class="sidebar-card">
                    <h3><i class="fas fa-bell"></i> Notifikasi</h3>
                    <div class="notification-item">
                        <div class="notification-icon">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <div class="notification-content">
                            <p>Pesanan #12345 sedang dalam pengiriman</p>
                            <small>2 jam yang lalu</small>
                        </div>
                    </div>
                    <div class="notification-item">
                        <div class="notification-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="notification-content">
                            <p>Diskon 15% untuk produk bunga musiman</p>
                            <small>1 hari yang lalu</small>
                        </div>
                    </div>
                    <a href="#" class="btn-view-all">Lihat Semua Notifikasi</a>
                </div>
            </div>
        </div>

        <div class="profile-tabs">
            <ul class="nav-tabs">
                <li class="active"><a href="#orders" data-tab="orders"><i class="fas fa-shopping-bag"></i> Pesanan Saya</a></li>
                <li><a href="#wishlist" data-tab="wishlist"><i class="fas fa-heart"></i> Wishlist</a></li>
                <li><a href="#reviews" data-tab="reviews"><i class="fas fa-star"></i> Ulasan Saya</a></li>
                <li><a href="#addresses" data-tab="addresses"><i class="fas fa-address-book"></i> Alamat Saya</a></li>
            </ul>
            
            <div class="tab-content">
                <div id="orders" class="tab-pane active">
                    <div class="empty-state">
                        <i class="fas fa-shopping-bag"></i>
                        <h3>Belum ada pesanan</h3>
                        <p>Anda belum melakukan pemesanan apapun</p>
                        <a href="{{ url_for('product_list') }}" class="btn btn-primary">Mulai Belanja</a>
                    </div>
                </div>
                
                <div id="wishlist" class="tab-pane">
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <h3>Wishlist kosong</h3>
                        <p>Tambahkan produk ke wishlist untuk menyimpannya di sini</p>
                        <a href="{{ url_for('product_list') }}" class="btn btn-primary">Jelajahi Produk</a>
                    </div>
                </div>
                
                <div id="reviews" class="tab-pane">
                    <div class="empty-state">
                        <i class="fas fa-star"></i>
                        <h3>Belum ada ulasan</h3>
                        <p>Beri ulasan untuk produk yang sudah Anda beli</p>
                    </div>
                </div>
                
                <div id="addresses" class="tab-pane">
                    <div class="address-card">
                        <div class="address-header">
                            <h4>Alamat Utama</h4>
                            <div class="address-actions">
                                <a href="#" class="btn-edit-address"><i class="fas fa-edit"></i></a>
                                <a href="#" class="btn-delete-address"><i class="fas fa-trash"></i></a>
                            </div>
                        </div>
                        <div class="address-content">
                            <p>{{ user.name }}</p>
                            <p>{{ user.address if user.address else 'Alamat belum diisi' }}</p>
                            <p>{{ user.phone if user.phone else 'Telepon belum diisi' }}</p>
                        </div>
                    </div>
                    
                    <button class="btn btn-add-address">
                        <i class="fas fa-plus"></i> Tambah Alamat Baru
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block styles %}
<style>
/* Profile Section */
.profile-section {
    padding: 40px 0;
}

.profile-header {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    margin-bottom: 40px;
    gap: 30px;
}

.profile-avatar-container {
    position: relative;
    width: 150px;
    height: 150px;
}

.profile-avatar {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #4a934a;
}

.default-avatar {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: #4a934a;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3.5rem;
    border: 3px solid #4a934a;
}

.avatar-actions {
    position: absolute;
    bottom: 5px;
    right: 5px;
}

.btn-edit-avatar {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background-color: #4a934a;
    color: white;
    border-radius: 50%;
    text-decoration: none;
    transition: all 0.3s;
}

.btn-edit-avatar:hover {
    background-color: #3a7a3a;
    transform: scale(1.1);
}

.profile-info {
    flex: 1;
    min-width: 250px;
}

.profile-info h1 {
    color: #333;
    margin-bottom: 5px;
    font-size: 1.8rem;
}

.member-since {
    color: #666;
    margin-bottom: 20px;
}

.profile-stats {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.stat-item {
    text-align: center;
}

.stat-number {
    font-size: 1.5rem;
    font-weight: 700;
    color: #4a934a;
}

.stat-label {
    font-size: 0.9rem;
    color: #666;
}

/* Profile Content */
.profile-content {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
    margin-bottom: 40px;
}

.profile-details {
    flex: 1;
    min-width: 300px;
    background: white;
    border-radius: 8px;
    padding: 30px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
}

.profile-sidebar {
    width: 300px;
}

.section-title {
    font-size: 1.3rem;
    color: #4a934a;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.detail-item {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.detail-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.detail-label {
    font-weight: 500;
    color: #555;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.detail-value {
    color: #333;
    font-size: 1.05rem;
}

.profile-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    flex-wrap: wrap;
}

.btn-outline-secondary {
    background: transparent;
    color: #6c757d;
    border: 1px solid #6c757d;
}

.btn-outline-secondary:hover {
    background: #6c757d;
    color: white;
}

/* Sidebar Cards */
.sidebar-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    margin-bottom: 20px;
}

.sidebar-card h3 {
    font-size: 1.1rem;
    color: #333;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.reward-points {
    font-size: 2rem;
    font-weight: 700;
    color: #4a934a;
    margin-bottom: 10px;
}

.btn-reward {
    display: inline-block;
    background: #f8b195;
    color: white;
    padding: 8px 15px;
    border-radius: 4px;
    text-decoration: none;
    font-size: 0.9rem;
    margin-top: 10px;
    transition: background 0.3s;
}

.btn-reward:hover {
    background: #f67280;
    color: white;
}

.notification-item {
    display: flex;
    gap: 10px;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
}

.notification-item:last-child {
    border-bottom: none;
}

.notification-icon {
    color: #4a934a;
    font-size: 1.2rem;
}

.notification-content p {
    margin-bottom: 5px;
    font-size: 0.9rem;
}

.notification-content small {
    color: #999;
    font-size: 0.8rem;
}

.btn-view-all {
    display: inline-block;
    color: #4a934a;
    text-decoration: none;
    font-size: 0.9rem;
    margin-top: 10px;
}

.btn-view-all:hover {
    text-decoration: underline;
}

/* Profile Tabs */
.profile-tabs {
    background: white;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    overflow: hidden;
}

.nav-tabs {
    display: flex;
    list-style: none;
    border-bottom: 1px solid #eee;
    padding: 0;
    margin: 0;
}

.nav-tabs li {
    flex: 1;
    text-align: center;
}

.nav-tabs li a {
    display: block;
    padding: 15px;
    color: #666;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s;
    border-bottom: 3px solid transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.nav-tabs li.active a {
    color: #4a934a;
    border-bottom-color: #4a934a;
}

.nav-tabs li a:hover {
    color: #4a934a;
    background-color: #f9f9f9;
}

.tab-content {
    padding: 30px;
}

.tab-pane {
    display: none;
}

.tab-pane.active {
    display: block;
}

.empty-state {
    text-align: center;
    padding: 40px 20px;
}

.empty-state i {
    font-size: 3rem;
    color: #ddd;
    margin-bottom: 20px;
}

.empty-state h3 {
    color: #666;
    margin-bottom: 10px;
}

.empty-state p {
    color: #999;
    margin-bottom: 20px;
}

/* Address Card */
.address-card {
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
}

.address-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.address-header h4 {
    margin: 0;
    font-size: 1.1rem;
}

.address-actions {
    display: flex;
    gap: 10px;
}

.btn-edit-address, .btn-delete-address {
    color: #666;
    text-decoration: none;
    transition: color 0.3s;
}

.btn-edit-address:hover {
    color: #4a934a;
}

.btn-delete-address:hover {
    color: #dc3545;
}

.address-content p {
    margin-bottom: 5px;
}

.btn-add-address {
    width: 100%;
    background: #f8f9fa;
    color: #666;
    border: 1px dashed #ddd;
    padding: 15px;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.3s;
}

.btn-add-address:hover {
    background: #f1f1f1;
    color: #4a934a;
    border-color: #4a934a;
}

/* Responsive Styles */
@media (max-width: 768px) {
    .profile-header {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-stats {
        justify-content: center;
    }
    
    .profile-sidebar {
        width: 100%;
    }
    
    .nav-tabs {
        flex-wrap: wrap;
    }
    
    .nav-tabs li {
        flex: 0 0 50%;
    }
}

@media (max-width: 576px) {
    .profile-actions {
        flex-direction: column;
    }
    
    .profile-actions .btn {
        width: 100%;
    }
    
    .nav-tabs li {
        flex: 0 0 100%;
    }
}
</style>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab functionality
    const tabLinks = document.querySelectorAll('.nav-tabs a');
    
    tabLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remove active class from all tabs
            tabLinks.forEach(tab => {
                tab.parentElement.classList.remove('active');
            });
            
            // Add active class to current tab
            this.parentElement.classList.add('active');
            
            // Hide all tab panes
            const tabPanes = document.querySelectorAll('.tab-pane');
            tabPanes.forEach(pane => {
                pane.classList.remove('active');
            });
            
            // Show current tab pane
            const targetPane = document.querySelector(this.getAttribute('href'));
            if (targetPane) {
                targetPane.classList.add('active');
            }
        });
    });
    
    // Initialize with first tab active if none is active
    if (!document.querySelector('.nav-tabs li.active')) {
        const firstTab = document.querySelector('.nav-tabs li');
        if (firstTab) {
            firstTab.classList.add('active');
            const firstPane = document.querySelector('.tab-pane');
            if (firstPane) {
                firstPane.classList.add('active');
            }
        }
    }
    
    // Add address button functionality
    const addAddressBtn = document.querySelector('.btn-add-address');
    if (addAddressBtn) {
        addAddressBtn.addEventListener('click', function() {
            alert('Fitur tambah alamat akan membuka form untuk menambahkan alamat baru');
        });
    }
});
</script>
{% endblock %}